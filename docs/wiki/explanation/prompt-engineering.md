# プロンプトエンジニアリング解説

## プロンプト構成

Manganize は 3 つのプロンプトを使用：

| プロンプト | 役割 |
|------------|------|
| `MANGANIZE_RESEARCHER_SYSTEM_PROMPT` | 情報収集・構造化 |
| `MANGANIZE_SCENARIO_WRITER_SYSTEM_PROMPT` | 脚本作成 |
| `MANGANIZE_IMAGE_GENERATION_SYSTEM_PROMPT` | 画像生成 |

## 主要な原則

### 1. 具体性

```
❌ Bad: "良い感じに描いて"
✅ Good: "太すぎない柔らかな主線、パステル調の彩色"
```

### 2. 構造化

セクションごとに整理：

```
# Role
...
# Character Reference
...
# Art Style & Layout
...
```

### 3. 制約の明示

ポジティブとネガティブの両方を記述：

```
# Negative Constraints
- 既存の雑誌名やロゴを含めないこと
- キャラクターの特徴を変更しないこと
```

### 4. 例の提供

キャラクター参照画像を添付：

```python
types.Part.from_bytes(data=load_kurage_image(), mime_type="image/png")
```

## Researcher プロンプト

技術情報を構造化された「ファクトシート」に整理：

```
# トピック名: [技術名]
# 推奨コマ数: [4コマ]

## 1. 技術的要点（3点要約）
## 2. エンジニアへのメリット/インパクト
## 3. シナリオ構成案（プロット）
## 4. 視覚化のヒント
```

シナリオパターン（起承転結型、ギャップ型など）を選択。

## Scenario Writer プロンプト

ファクトシートから脚本を作成：

```
**【1コマ目】**
* **状況:** [導入]
* **視覚的指示:** [作画指示]
* **セリフ:** くらげ: 「...」
```

キャラクター設定：
- 名前: くらがりくらげ
- 口調: ニュートラルで気だるげ（「～かも」「～だね」）

## Image Generation プロンプト

「まんがタイムきらら」風の画像生成：

```
# Art Style & Props
- 太すぎない柔らかな主線
- 鮮やかながらも目に優しい彩色
- かわいいデフォルメ

# Layout & Composition
- 縦に並んだ4コマ漫画
- セリフは日本語

# Negative Constraints
- 雑誌のロゴを含めない
- キャラクターの細部を変更しない
```

## デバッグ

### スタイルが期待と異なる

```diff
- スタイル：漫画風
+ スタイル：「まんがタイムきらら」風
+     - 特徴：太すぎない柔らかな主線
```

### キャラクターが一貫しない

- 参照画像の品質を確認（1024×1024px 以上推奨）
- プロンプトで「添付画像を厳密に参照」と明記

### セリフが英語になる

```diff
- 吹き出し：読みやすい配置
+ 吹き出し：読みやすい配置、セリフは「日本語」で記述
```

## 反復改善

```
1. 初期プロンプトで生成
2. 問題点を特定
3. プロンプトを修正
4. 再生成して確認
（繰り返し）
```
